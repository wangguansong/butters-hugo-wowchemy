---
title: 7.12 条件还是无条件期望测试误差？ 😱
summary: >
  第 254-257 页。从某个特定的训练集数据中估计其测试误差一般来说并不简单。然而，交叉验证以及其他相关的方法可以较好地估计期望误差。

date: 2018-12-13T10:52:00+08:00
lastmod: 2018-12-13T11:52:00+08:00
linktitle: 7.12 条件还是无条件？ 😱
draft: false
math: true

type: book
weight: 712

authors: ["Butters"]
tags: ["译文"]
categories: ["统计学习基础（译注）"]

---

{{< figure
  id="f0714"
  src="https://public.guansong.wang/eslii/ch07/eslii_fig_07_14.png"
  title="**图 7.14**：图 7.3 右上图场景中产生的 100 组模拟数据的条件预测误差 $\text{Err}\_\mathcal{T}$、十折交叉验证和留一法交叉验证曲线。加粗红色曲线为期望预测误差 $\text{Err}$，加粗黑色曲线为期望交叉验证曲线 $E\_\mathcal{T}\text{CV}\_{10}$ 和 $E\_\mathcal{T}\text{CV}\_{N}$。右下图展示了交叉验证曲线与条件误差的平均绝对离差（mean absolute deviation），即 $E\_\mathcal{T}\|\text{CV}\_K-\text{Err}\_\mathcal{T}\|$，$K=10$ 为蓝色，$K=N$ 为绿色；同时也展示了与期望误差的平均绝对离差，即 $E\_\mathcal{T}\|\text{CV}\_{10}-\text{Err}\|$（橙色）。"
>}}

图 7.14 和 7.15 考察了一个疑问：
交叉验证是否很好地估计了给定一个训练集 $\mathcal{T}$
的条件测试误差 $\text{Err}\_\mathcal{T}$（第 228 页的表达式 7.15），
还是只估计了期望测试误差。
根据图 7.3 的右上图的“回归/线性模型”场景生成 100 组训练集，
得出每个训练集的作为特征子集大小的函数的条件误差曲线
$\text{Err}\_\mathcal{T}$（图 7.14 左上图）。
接下来两个图为十折和 N 折交叉验证，后者也被称为留一法（LOO）。
每个图中的加粗红色曲线为期望误差 $\text{Err}$，
加粗黑色曲线为期望交叉验证曲线。
右下图展示了交叉验证对条件误差和期望误差的近似准确度。

由于 N 折交叉验证对每个新测试点都用几乎全训练集重新拟合，
可能会认为它对 $\text{Err}\_\mathcal{T}$ 的近似更好。
另一方面，由于十折交叉验证是对有所差异的训练集的平均，
可能会认为它对 $\text{Err}$ 的近似更好。
从图中看，十折对 $\text{Err}\_\mathcal{T}$ 的估计要好于 N 折，
并且对 $\text{Err}$ 的估计更好。
事实上，两个图中黑色曲线与红色曲线基本重合，
说明两个交叉验证曲线对 $\text{Err}$ 都是基本无偏的，
但十折的方差更低。
Efron (1983) 也得到了类似的结果。

{{< figure
  id="f0715"
  src="https://public.guansong.wang/eslii/ch07/eslii_fig_07_15.png"
  title="**图 7.15**：图 7.3 右上图场景中产生的 100 组训练集的交叉验证误差估计与真实条件误差的散点图。十折和留一法交叉验证用不同的颜色标记。前三个图对应着不同的特征子集大小 $p$，垂直和水平虚线标记了 $\text{Err}(p)$ 的位置。尽管散点图中没有明显的相关性，但右下图中显示大多数情况下相关系数是负的。"
>}}

图 7.15 展示了 100 组模拟中十折和 N 折交叉验证误差估计
对真实条件误差的散点图。
尽管在散点图中看不出有相关性，
但右下图中显示大部分的相关系数是负的，
这个奇怪的现象在之前也被注意到过。
这种负相关性也是两种交叉验证都对
$\text{Err}\_\mathcal{T}$ 的估计不够好的原因。
每个图中的虚线标记了 $\text{Err}(p)$，
即大小为 $p$ 的最优子集模型的期望误差。
与之前一样，两种形式的交叉验证都大致对期望误差无偏，
但不同训练集的测试误差的变动比较大。

在图 7.3 的四个实验场景中，这个“回归/线性模型”场景的
真实和预测测试误差之间的相关性最高。
我们猜测这种现象也会发生在自助法和任意其他对条件预测误差估计的方法中。

综上，从某个特定的训练集数据中
估计其测试误差一般来说并不简单。
然而，交叉验证以及其他相关的方法可以较好地估计期望误差
$\text{Err}$。